import{a as b,r as n,u as W,j as a,B as $,m as M}from"./index-e2ec6af0.js";import{h as m,d as k,C as B}from"./ckeditor-59ef8a65.js";const I=()=>{const{role:O,teamName:d,memberName:C,memberId:R}=b(),[i,h]=n.useState(d),[u,D]=n.useState(null),[N,x]=n.useState([]),g=m().startOf("week").toDate(),[l,L]=n.useState(g),j=m().endOf("week").toDate(),T=W();n.useEffect(()=>{h(d);const e=b.subscribe(s=>{s.teamName!==i&&h(s.teamName)});return()=>e()},[]),n.useEffect(()=>{(async()=>{const s={memberId:null,weekStartDate:l.toISOString()},t=await M("/WeeklyStatus/GetAllWeeklyStatusesByStartDate","POST",s);if(t){D(t);const r=t.filter(c=>!c.weeklyStatus);x(r)}})()},[i,l]);const v=(()=>{if(!u)return"";let e=`<h2>${i} Weekly Status Report</h2>`;return e+=`<h3>${l.toDateString()} - ${j.toDateString()}</h3>`,u.filter(({weeklyStatus:s})=>s!==null).forEach(({memberName:s,weeklyStatus:t})=>{var c,f,p;e+=`<h3>${s}</h3>`,e+="<h4>What was done this week:</h4>",e+="<ul>",(c=t==null?void 0:t.doneThisWeek)==null||c.forEach(o=>{e+=`<li>${o.taskDescription}`,o.subtasks&&o.subtasks.length>0&&(e+="<ul>",o.subtasks.forEach(_=>{e+=`<li>${_.subtaskDescription}</li>`}),e+="</ul>"),e+="</li>"}),e+="</ul>",e+="<h4>Plan for next week:</h4>",e+="<ul>",(f=t==null?void 0:t.planForNextWeek)==null||f.forEach(o=>{e+=`<li>${o}</li>`}),e+="</ul>",e+="<h4>Blockers:</h4>",e+=`<p>${(t==null?void 0:t.blockers)??"None"}</p>`,e+="<h4>Upcoming PTO:</h4>";const r=(p=t==null?void 0:t.upcomingPTO)==null?void 0:p.map(o=>m(o).format("MMM DD"));r!=null&&r.length&&(e+=r.join(", "))}),e})(),E=async()=>{T("/weekly-status")};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"card mt-5 div__container",children:a.jsx("div",{className:"card-body card-content",children:a.jsx(k.CKEditor,{editor:B,data:v,config:{toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","insertTable","undo","redo","selectAll","copy"]}})})}),a.jsxs("div",{className:"d-flex flex-column mt-2 div__secondary",children:[a.jsx("span",{className:"div__secondary__content",children:"Folks who have not yet reported:"})," ",N.map(e=>e.memberName).join(", ")]}),a.jsx("div",{className:"form__buttons",children:a.jsx($,{variant:"secondary",onClick:E,className:"mt-3 ml-2",children:"Back"})})]})};export{I as default};
